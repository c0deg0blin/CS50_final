{% extends "layout.html" %}

{% block title %}
Main
{% endblock %}

{% block main %}
<div>
    <h1>TripPacker</h1>
    <table>
        <thead>
            <tr>
                {% for column_name in column_names %}
                    {% if column_name.lower() == "id" %}
                        <th class="hidden_col">{{ column_name }}</th>
                    {% else %}
                        <th>{{ column_name }}</th>
                    {% endif %}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in rows %}
                <!--  The loop.index attribute assigns the current row
                    index (1-based) to each <tr> element. -->
                <tr data-row="{{ loop.index }}">
                    {% for key in row %}
                        {% if key.lower() == "id" %}
                            <td class="hidden_col">{{ row[key] }}</td>
                        {% elif key.lower() == "packed" %}
                            <form action="/" method="post">
                                <td> <input type="checkbox" class="packed_cb"> </td>
                            </form>
                        {% else %}
                            <td>{{ row[key] }}</td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <script>
        $(document).ready(function() {
            $('.packed_cb').change(function() {
                const isChecked = $(this).prop('checked');
                const rowNumber = $(this).closest('tr').data('row');
                const idValue = $(this).closest('tr').find('td.hidden_col').text(); // Assuming the class is "hidden_col"
                
                if (isChecked) {
                    console.log(`Checkbox in row ${rowNumber} is checked. ID value: ${idValue}`)
                }
            });
        });
    </script>
{% endblock %}