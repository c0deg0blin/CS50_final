{% extends "layout.html" %}

{% block title %}
Main
{% endblock %}

{% block main %}
<div>
    <h1>TripPacker</h1>
    <table>
        <thead>
            <tr>
                {% for column_name in column_names %}
                    {% if column_name.lower() == "id" %}
                        <th class="hidden_col">{{ column_name }}</th>
                    {% else %}
                        <th>{{ column_name }}</th>
                    {% endif %}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <form action="/" method="post">
                        <input onChange="this.form.submit()" type="checkbox" class="packed_cb" name="cb1" unchecked> 
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
    <script>
        $(document).ready(function() {
            $('.packed_cb').change(function() {
                const isChecked = $(this).prop('checked');
                const rowNumber = $(this).closest('tr').data('row');
                const idValue = $(this).closest('tr').find('td.hidden_col').text(); // Assuming the class is "hidden_col"
                
                if (isChecked) {
                    console.log(`Checkbox in row ${rowNumber} is checked. ID value: ${idValue}`)
                    $("#formName").submit();
                }
                else {
                    console.log(`Checkbox in row ${rowNumber} is unchecked. ID value: ${idValue}`)
                    $("#formName").submit();
                }
            });
        });
    </script>
{% endblock %}